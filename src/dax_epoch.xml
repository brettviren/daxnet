<class
    name = "dax_epoch"
    signature = "0"
    title = "DAX Epoch Message Codec"
    script = "zproto_codec_c"
    package_dir = "../include"
    pubsub = "0"
    >
  <!-- broken if pubsub="1"-->

  The DAX Epoch Codec.

  <define name = "BOT"  value = "0x8000000000000001"> 
    The end of time as measured in a 64 bit clock.
  </define>

  <define name = "EOT"  value = "0x7FFFFFFFFFFFFFFF">
    The end of time as measured in a 64 bit clock.
  </define>


  <message name = "DEBUT">
    Declare an epoch.

    <field name = "ident" type = "number" size = "4">The epoch identifier.</field>

    <field name = "dtbeg" type = "number" size="8">Begin time measured in data clock.</field>

    <field name = "dtend" type = "number" size="8">End time measured in data clock.</field>

    <field name = "declared" type = "number" size = "8">Wall clock time when declared.</field>

  </message>

  <message name = "RESCIND">
    Invalidate a previously declared epoch.
    <field name = "ident" type = "number" size = "4">The epoch identifier.</field>
    <field name = "declared" type = "number" size = "8">Wall clock time when declared.</field>
  </message>

  <message name = "STATUS">
    Request current valid epochs.
    <field name = "dtbeg" type = "number" size="8">Begin time measured in data clock.</field>
  </message>

  <message name = "TIMELINE">
    A timeline.
    <field name = "ident" type = "number" size = "4">The epoch identifier.</field>

    <field name = "epochs" type = "msg">
      An ordered list of epochs as a message.  One frame per DEBUT.
    </field>
  </message>

  <message name = "ERROR">
    Command failed for some specific reason
    <field name = "status" type = "number" size = "2">3-digit status code</field>
    <field name = "reason" type = "string">Printable explanation</field>

  </message>

  <!-- Success codes -->
  <define name = "SUCCESS" value = "200" />
  <define name = "STORED" value = "201" />
  <define name = "DELIVERED" value = "202" />

  <!-- Temporary errors -->
  <define name = "NOT DELIVERED" value = "300" />
  <define name = "CONTENT TOO LARGE" value = "301" />
  <define name = "TIMEOUT EXPIRED" value = "302" />
  <define name = "CONNECTION REFUSED" value = "303" />

  <!-- Application errors -->
  <define name = "RESOURCE LOCKED" value = "400" />
  <define name = "ACCESS REFUSED" value = "401" />
  <define name = "NOT FOUND" value = "404" />

  <!-- System errors -->
  <define name = "COMMAND INVALID" value = "500" />
  <define name = "NOT IMPLEMENTED" value = "501" />
  <define name = "INTERNAL ERROR" value = "502" />
  
</class>
